{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Home","text":""},{"location":"#_1","title":"\uc18c\uac1c","text":"<p>\uc548\ub155\ud558\uc138\uc694. \uc545\ubd84 mkdocs\uc5d0 \uc624\uc2e0\uac83\uc744 \ud658\uc601\ud569\ub2c8\ub2e4. mkdocs\ub294 \ube14\ub85c\uadf8\uc640 \uc720\ud22c\ube0c\uc5d0 \uc788\ub294 \ub0b4\uc6a9\uc744 \ubaa8\uc558\uc2b5\ub2c8\ub2e4.</p>"},{"location":"#_2","title":"\uc678\ubd80 \ub9c1\ud06c","text":"<ul> <li>\ube14\ub85c\uadf8: \ud2f0\uc2a4\ud1a0\ub9ac</li> <li>\uc720\ud22c\ube0c: \uc545\ubd84 \uc77c\uc0c1</li> <li>github: https://github.com/choisungwook</li> </ul>"},{"location":"AI/chroma%20vectorDB%20%EC%A0%80%EC%9E%A5%EA%B3%BC%20%EB%A1%9C%EB%93%9C/","title":"chroma vectorDB \uc800\uc7a5\uacfc \ub85c\ub4dc","text":""},{"location":"AI/chroma%20vectorDB%20%EC%A0%80%EC%9E%A5%EA%B3%BC%20%EB%A1%9C%EB%93%9C/#_1","title":"\uac1c\uc694","text":"<p>chroma vectorDB\uc5d0 \ub370\uc774\ud130\ub97c \uc800\uc7a5\ud558\ub294 \ubc29\ubc95\uacfc \ub85c\ub4dc\ud558\ub294 \ubc29\ubc95\uc744 \uc124\uba85\ud569\ub2c8\ub2e4.</p>"},{"location":"AI/chroma%20vectorDB%20%EC%A0%80%EC%9E%A5%EA%B3%BC%20%EB%A1%9C%EB%93%9C/#_2","title":"\uc800\uc7a5 \ubc29\ubc95","text":"<p>persist_directory\uc778\uc790\uc5d0 \uc800\uc7a5\ud560 \uc704\uce58\ub97c \uc124\uc815\ud569\ub2c8\ub2e4. jupyter\ub97c \uc0ac\uc6a9\ud558\ub294 \uacbd\uc6b0 persist \ud568\uc218\ub97c \ud638\ucd9c\ud574\uc57c \ud569\ub2c8\ub2e4.</p> <pre><code>from langchain.vectorstores import Chroma\n\nvector_db = Chroma.from_documents(\n  documents=chunks,\n  embedding=embeddings,\n  persist_directory=\"./vectorstore/example-embedding\",\n)\n\n# jupyter\ub97c \uc0ac\uc6a9\ud558\uba74 persist()\ud568\uc218\ub97c \ud638\ucd9c\ud574\uc57c \ud568\n# reference: https://stackoverflow.com/questions/77231763/cannot-load-persisted-db-using-chroma-langchain\nvector_db.persist()\n</code></pre>"},{"location":"AI/chroma%20vectorDB%20%EC%A0%80%EC%9E%A5%EA%B3%BC%20%EB%A1%9C%EB%93%9C/#_3","title":"\ub85c\ub4dc \ubc29\ubc95","text":"<p>persist_directory\uc778\uc790\uc5d0 \ub370\uc774\ud130\uac00 \uc788\ub294 \uacbd\ub85c\ub97c \uc124\uc815\ud569\ub2c8\ub2e4.</p> <pre><code>import chromadb\nfrom langchain.vectorstores import Chroma\n\nclient_settings = chromadb.config.Settings(\n  persist_directory=\"./vectorstore/example-embedding/\",\n  chroma_db_impl=\"parquet\"\n)\nvector_db = Chroma(\n  client_settings=client_settings,\n  embedding_function=embeddings\n)\n</code></pre>"},{"location":"AI/chroma%20vectorDB%20%EC%A0%80%EC%9E%A5%EA%B3%BC%20%EB%A1%9C%EB%93%9C/#_4","title":"\ucc38\uace0\uc790\ub8cc","text":"<ul> <li>https://python.langchain.com/docs/integrations/vectorstores/chroma</li> <li>https://stackoverflow.com/questions/76232375/langchain-chroma-load-data-from-vector-database</li> </ul>"},{"location":"Docker/Add%20linux%20user/","title":"Add linux user","text":""},{"location":"Docker/Add%20linux%20user/#_1","title":"\uac1c\uc694","text":"<ul> <li>\uc774 \ubb38\uc11c\ub294 Dockerfie\uc5d0\uc11c \ub9ac\ub205\uc2a4 \uc720\uc800\ub97c \ucd94\uac00\ud558\ub294 \ubc29\ubc95\uc744 \uc124\uba85\ud569\ub2c8\ub2e4.</li> </ul>"},{"location":"Docker/Add%20linux%20user/#dockerfile","title":"Dockerfile","text":"<pre><code># Variables\nARG USERNAME=ansible\nARG USER_UID=1000\nARG USER_GID=$USER_UID\n\n# Create the user\nRUN groupadd --gid $USER_GID $USERNAME \\\n    &amp;&amp; useradd --uid $USER_UID --gid $USER_GID -m $USERNAME \\\n    &amp;&amp; apt-get update \\\n    &amp;&amp; apt-get install -y sudo \\\n    &amp;&amp; echo $USERNAME ALL=\\(root\\) NOPASSWD:ALL &gt; /etc/sudoers.d/$USERNAME \\\n    &amp;&amp; chmod 0440 /etc/sudoers.d/$USERNAME\n\n\nUSER $USERNAME\n</code></pre>"},{"location":"ansible/install/aws/","title":"Aws","text":""},{"location":"ansible/install/aws/#_1","title":"\uac1c\uc694","text":"<ul> <li>AWS EC2\uc778\uc2a4\ud134\uc2a4\ub97c \uc0ac\uc6a9\ud558\uc5ec ansible \uc2e4\uc2b5\ud658\uacbd \uad6c\ucd95</li> </ul>"},{"location":"ansible/install/aws/#_2","title":"\uc81c\uc57d\uc0ac\ud56d","text":"<ul> <li>\ud56b\uc2a4\ud31f\uc744 \uc0ac\uc6a9\ud558\ub294 \ud658\uacbd\uc740 EC2 \uc778\uc2a4\ud134\uc2a4\uc5d0 \uc811\uc18d \ubabb\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4. IP\uac00 \uace0\uc815\uc774 \uc544\ub2c8\uae30 \ub584\ubb38\uc785\ub2c8\ub2e4.</li> </ul>"},{"location":"ansible/install/aws/#_3","title":"\uc900\ube44","text":"<ul> <li>AWS CLI</li> <li>Administrator\uad8c\ud55c\uc744 \uac16\ub294 AWS \uacc4\uc815 \ub610\ub294 IAM role</li> <li>\ub0b4 PC public IP \ud655\uc778: EC2\uc778\uc2a4\ud134\uc2a4\uc5d0 \uc811\uc18d\ud558\ub294 IP\ub97c \ub0b4PC\ub85c \uc81c\ud55c\ud558\uae30 \uc704\ud574 IP\ub97c \ud655\uc778</li> </ul> <pre><code>curl https://ipinfo.io/ip ; echo\n</code></pre>"},{"location":"ansible/install/aws/#_4","title":"\uc2e4\uc2b5\ud658\uacbd \uad6c\ucd95","text":"<ul> <li>AWS console\uc5d0\uc11c SSH\ud0a4\ub97c \uc0dd\uc131\ud569\ub2c8\ub2e4.</li> </ul> <ul> <li>cloudformation \ud15c\ud50c\ub9bf\uc744 \ub2e4\uc6b4\ub85c\ub4dc \ubc1b\uc2b5\ub2c8\ub2e4.</li> </ul> <pre><code>curl -O https://s3.ap-northeast-2.amazonaws.com/cloudformation.cloudneta.net/Ansible/a101-1w.yaml\n</code></pre> <ul> <li>AWS CLI\ub85c cloudformation \ud15c\ud50c\ub9bf\uc744 \ubc30\ud3ec\ud569\ub2c8\ub2e4.</li> </ul> <pre><code>EC2_SSHKEY=\"ansible-test\"\naws cloudformation deploy \\\n  --template-file a101-1w.yaml \\\n  --stack-name ansible-lab \\\n  --parameter-overrides KeyName=${EC2_SSHKEY} \\\n  SgIngressSshCidr=$(curl -s ipinfo.io/ip)/32 \\\n  --region ap-northeast-2\n</code></pre> <ul> <li>cloudformation\uc774 \ubc30\ud3ec\ub418\uba74 \uc544\ub798\ucc98\ub7fc stack\uc774 \uc0dd\uc131\ub429\ub2c8\ub2e4.</li> </ul> <ul> <li>SSH\ud0a4\ub97c \uc0ac\uc6a9\ud558\uc5ec EC2\uc778\uc2a4\ud134\uc2a4 \ud130\ubbf8\ub110\uc5d0 \uc811\uc18d\ud569\ub2c8\ub2e4. EC2 \uc778\uc2a4\ud134\uc2a4 public IP\ub294 cloudformation output\uc5d0\uc11c \ud655\uc778\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4.</li> </ul> <pre><code># EC2\uc778\uc2a4\ud134\uc2a4 public IP\ud655\uc778\nEC2_PUBLIC_IP=$(aws cloudformation describe-stacks --stack-name ansible-lab --query 'Stacks[*].Outputs[0].OutputValue' --output text --region ap-northeast-2)\necho $EC2_PUBLIC_IP\n\n# ssh \uc811\uc18d\nssh -i {ssh\ud0a4 \uacbd\ub85c} ubuntu@$EC2_PUBLIC_IP\n</code></pre>"},{"location":"ansible/install/aws/#_5","title":"\uc0ad\uc81c","text":"<pre><code>aws cloudformation delete-stack --stack-name ansible-lab --region ap-northeast-2\n</code></pre>"},{"location":"kubernetes/ALB_readiness_gate/","title":"Index","text":""},{"location":"kubernetes/ALB_readiness_gate/#_1","title":"\uac1c\uc694","text":"<ul> <li>EKS\uc5d0\uc11c pod Readiness gate \uc608\uc81c</li> </ul>"},{"location":"kubernetes/ALB_readiness_gate/#_2","title":"\uc2e4\uc2b5\ud658\uacbd","text":"<ul> <li>EKS 1.30</li> </ul>"},{"location":"kubernetes/ALB_readiness_gate/#_3","title":"\uc900\ube44","text":"<ul> <li> <p>ALB controller\uc744 \uc124\uce58\ud569\ub2c8\ub2e4. \uc774 \uc608\uc81c\uc5d0\uc11c\ub294 helmfile\uc744 \uc0ac\uc6a9\ud558\uc5ec ALB contorller\ub97c \uc124\uce58\ud569\ub2c8\ub2e4.</p> </li> <li> <p>helmfile\uc744 \uc124\uce58\ud569\ub2c8\ub2e4.</p> </li> </ul> <pre><code>brew install helmfile\n</code></pre> <ol> <li>helmfile \ud50c\ub7ec\uadf8\uc778\uc744 \ub2e4\uc6b4\ub85c\ub4dc \ubc1b\uc2b5\ub2c8\ub2e4.</li> </ol> <pre><code>helmfile init\n</code></pre> <ol> <li>ALB controller helm values\ub97c \uc218\uc815\ud569\ub2c8\ub2e4. helmfile.yaml\uc5d0\uc11c environment\uac12\uc744 \uc218\uc815\ud569\ub2c8\ub2e4.</li> </ol> <pre><code>$ cat helmfile.yaml\nenvironments:\n  default:\n    values:\n    - clusterName: {EKS \uc774\ub984}\n      region: {aws region}\n      vpcId: {VPC id}\n      irsa: {ALB controller IRSA role}\n</code></pre> <ol> <li>helmfile\uc744 apply\ud569\ub2c8\ub2e4.</li> </ol> <pre><code>helmfile apply\n</code></pre> <ol> <li>ALB contrller\uc124\uce58\ub97c \ud655\uc778\ud569\ub2c8\ub2e4.</li> </ol> <pre><code>$ kubectl -n kube-system get pod -l app.kubernetes.io/instance=aws-load-balancer-controller\nNAME                                            READY   STATUS    RESTARTS   AGE\naws-load-balancer-controller-67cc89b776-h7zjq   1/1     Running   0          3m3s\naws-load-balancer-controller-67cc89b776-kv88n   1/1     Running   0          3m3s\n</code></pre> <ol> <li>\uc2e4\uc2b5\uc774 \ub05d\ub098\uba74 ALB controller\ub97c \uc0ad\uc81c\ud569\ub2c8\ub2e4.</li> </ol> <pre><code>helmfile destroy\n</code></pre>"},{"location":"kubernetes/ALB_readiness_gate/#_4","title":"\uc608\uc81c","text":""},{"location":"kubernetes/ALB_readiness_gate/#_5","title":"\uc608\uc81c \ubc30\ud3ec","text":"<ol> <li>httpbin deployment, service, ingress\ub97c \ubc30\ud3ec\ud558\uc138\uc694.</li> </ol> <pre><code>kubectl apply -f ./manifests/httpbin/\n</code></pre> <ol> <li>pod, ingress\uac00 \uc815\uc0c1\uc778\uc9c0 \ud655\uc778\ud569\ub2c8\ub2e4.</li> </ol> <pre><code>$ kubectl get pod,ingress -n default\nNAME                          READY   STATUS    RESTARTS   AGE\npod/httpbin-dcc79b8c7-4456k   1/1     Running   0          12m\n\nNAME                                CLASS   HOSTS   ADDRESS                                                                      PORTS   AGE\ningress.networking.k8s.io/httpbin   alb     *       k8s-default-httpbin-xxxxxxxxxxxxxxxxxxxxxx.ap-northeast-2.elb.amazonaws.com   80      5m56s\n</code></pre> <ol> <li>ALB \ub3c4\uba54\uc778\uc73c\ub85c http GET\uc694\uccad\uc744 \ud569\ub2c8\ub2e4.</li> </ol> <pre><code>HTTPBIN_ADDRESS=$(kubectl get ingress httpbin -o jsonpath='{.status.loadBalancer.ingress[0].hostname}')\ncurl $HTTPBIN_ADDRESS\n</code></pre>"},{"location":"kubernetes/ALB_readiness_gate/#pod-restart-curl","title":"pod restart \ud6c4 curl \uc694\uccad \uc5d0\ub7ec \ud655\uc778(\uc5d0\ub7ec \uc7ac\ud604)","text":"<ol> <li>\uc0c8\ub85c\uc6b4 \ud130\ubbf8\ub110\uc744 \uc5f4\uace0 ALB \ub3c4\uba54\uc778\uc5d0 \uacc4\uc18d curl\uc744 \uc694\uccad\ud569\ub2c8\ub2e4. \uadf8\ub9ac\uace0 kubectl \uc0c1\ud0dc\ub3c4 \uacc4\uc18d \uc870\ud68c\ud558\uba74 \uc88b\uc2b5\ub2c8\ub2e4.</li> </ol> <pre><code>$ URL=\"${HTTPBIN_ADDRESS}\"; while true; do curl -o /dev/null -s -w \"%{http_code}\\n\" \"$URL\"; sleep 0.1; done\n200\n200\n</code></pre> <pre><code>watch kubectl get ep\nwatch kubectl get pod\n</code></pre> <ol> <li>AWS console\uc5d0 \ub85c\uadf8\uc778\ud55c \ud6c4 Target Group\uc758 Target\ub97c \uc5ec\uc138\uc694.</li> </ol> <ol> <li>\uc0c8\ub85c\uc6b4 \ud130\ubbf8\ub110\uc5d0\uc11c pod\ub97c \uc7ac\uc2e4\ud589\ud569\ub2c8\ub2e4.</li> </ol> <pre><code>kubectl rollout restart deployment/httpbin\n</code></pre> <ol> <li>AWS console\uc5d0\uc11c Target group\uc744 \ud655\uc778\ud574\ubcf4\uc138\uc694. Target Healthy \uc0c1\ud0dc\uac00 1\uac1c\ub3c4 \uc5c6\uc2b5\ub2c8\ub2e4.</li> </ol>"},{"location":"kubernetes/ALB_readiness_gate/#_6","title":"\uc624\ub958 \uc218\uc815","text":"<ol> <li>default namespace\uc5d0 readiness gate\ub97c \uc124\uc815\ud558\uc138\uc694.</li> </ol> <pre><code>kubectl label namespace default elbv2.k8s.aws/pod-readiness-gate-inject=enabled\n</code></pre> <ol> <li>pod\ub97c \uc7ac\uc2e4\ud589\ud569\ub2c8\ub2e4.</li> </ol> <pre><code>kubectl rollout restart deployment/httpbin\n</code></pre> <ol> <li>AWS console\uc5d0\uc11c Target group\uc744 \ud655\uc778\ud574\ubcf4\uc138\uc694. \uc0c8\ub85c\uc6b4 pod\uac00 target\uc5d0 \ucd94\uac00\ub41c \ub2e4\uc74c \uae30\uc874 pod\uac00 target\uc5d0\uc11c \uc81c\uac70\ub429\ub2c8\ub2e4.</li> </ol>"},{"location":"kubernetes/ALB_readiness_gate/#pod-readiness-gate","title":"pod readiness gate \uc81c\uac70","text":"<ul> <li>pod readiness gate \uc81c\uac70\ud558\ub824\uba74 default namespace\uc5d0 \uc788\ub294 pod readiness gate label\uc744 \uc0ad\uc81c\ud569\ub2c8\ub2e4.</li> </ul> <pre><code>kubectl label namespace default elbv2.k8s.aws/pod-readiness-gate-inject-\n</code></pre>"},{"location":"kubernetes/ALB_readiness_gate/#_7","title":"\ucc38\uace0\uc790\ub8cc","text":"<ul> <li>https://docs.aws.amazon.com/eks/latest/best-practices/load-balancing.html</li> <li>https://kubernetes-sigs.github.io/aws-load-balancer-controller/v2.1/deploy/pod_readiness_gate/</li> </ul>"},{"location":"kubernetes/ALB_readiness_gate/charts/","title":"Index","text":""},{"location":"kubernetes/ALB_readiness_gate/charts/#_1","title":"\uac1c\uc694","text":"<ul> <li>helm chart values \ubaa8\uc74c</li> </ul>"},{"location":"kubernetes/ALB_readiness_gate/charts/#_2","title":"\ubaa9\ucc28","text":"<ul> <li>EKS ALB controller</li> </ul>"},{"location":"kubernetes/ALB_readiness_gate/charts/#_3","title":"\ucc38\uace0\uc790\ub8cc","text":"<ul> <li>https://github.com/kubernetes-sigs/aws-load-balancer-controller/issues/1561</li> </ul>"},{"location":"kubernetes/ALB_readiness_gate/manifests/httpbin/","title":"Index","text":""},{"location":"kubernetes/ALB_readiness_gate/manifests/httpbin/#_1","title":"\uac1c\uc694","text":"<ul> <li>kong httpbin \uc560\ud50c\ub9ac\ucf00\uc774\uc158 \ubc30\ud3ec</li> </ul>"},{"location":"kubernetes/argocd/1.%20argocd%20extension/","title":"1. argocd extension","text":""},{"location":"kubernetes/argocd/1.%20argocd%20extension/#_1","title":"\uc720\ud22c\ube0c \ub9c1\ud06c","text":"<p>argoCD Extension \uc124\uba85 \uc720\ud22c\ube0c \ub9c1\ud06c</p>"},{"location":"kubernetes/argocd/1.%20argocd%20extension/#argocd-extension","title":"ArgoCD Extension\uc774\ub780?","text":"<p>ArgoCD extension\uc740 ArgoCD\uae30\ubcf8 \uae30\ub2a5\uc744 \ud655\uc7a5\ud569\ub2c8\ub2e4.</p> <ul> <li>ArgoCD UI \ucee4\uc2a4\ud130\ub9c8\uc774\uc9d5</li> <li>\ud5ec\uc2a4\uccb4\ud06c \ucee4\uc2a4\ud130\ub9c8\uc774\uc9d5</li> <li>\ucee4\uc2a4\ud140 \ubc84\ud2bc \ucd94\uac00</li> </ul>"},{"location":"kubernetes/argocd/1.%20argocd%20extension/#_2","title":"\uc124\uce58 \ubc29\ubc95","text":"<p>extension \uc124\uce58 \ubc29\ubc95\uc740 initContainer\ub97c \uc0ac\uc6a9\ud574\uc57c \ud569\ub2c8\ub2e4. initContainer \ud658\uacbd\ubcc0\uc218 EXTENSION_URL\uc5d0 \uc124\uce58\ud560 extension\uc744 \uba85\uc2dc\ud558\uba74 \ub429\ub2c8\ub2e4. mainContainer\ub294 initContainer\uac00 \uc124\uce58\ud55c extension\uc744 \uac00\uc838\uc624\uae30 \uc704\ud574 volumeMount\ub85c \uac00\uc838\uc635\ub2c8\ub2e4.</p>"},{"location":"kubernetes/argocd/1.%20argocd%20extension/#_3","title":"\uc608\uc81c","text":"<p>\uc544\ub798 \uc608\uc81c\ub294 argocd-server\uc5d0 Argo Rollouts UI extension\uc744 \uc124\uce58\ud588\uc2b5\ub2c8\ub2e4. Argo Rollouts UI extension\uc740 Rollout \ub300\uc2dc\ubcf4\ub4dc\ub97c Argo \uc6f9 UI\uc5d0 \ud45c\uc2dc\ud574\uc90d\ub2c8\ub2e4.</p> <p></p> <p>Argo Rollouts UI extension\uc124\uce58\uc5d0 \uc0ac\uc6a9\ud55c manifest\ub294 \uc544\ub798\uc640 \uac19\uc2b5\ub2c8\ub2e4.</p> <pre><code>apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: argocd-server\n  namespace: argocd\nspec:\n  template:\n    spec:\n      initContainers:\n      - name: argo-rollouts-extension\n        image: quay.io/argoprojlabs/argocd-extension-installer:v0.0.1\n        env:\n        - name: EXTENSION_URL\n          value: https://github.com/argoproj-labs/rollout-extension/releases/download/v0.3.3/extension.tar\n        volumeMounts:\n        - name: extensions\n          mountPath: /tmp/extensions/\n        securityContext:\n          runAsUser: 1000\n          allowPrivilegeEscalation: false\n      containers:\n      - name: argocd-server\n        volumeMounts:\n        - name: extensions\n          mountPath: /tmp/extensions/\n      volumes:\n      - name: extensions\n        emptyDir: {}\n...\uc774\ud558\uc0dd\ub7b5\n</code></pre>"},{"location":"kubernetes/istio/","title":"Index","text":""},{"location":"kubernetes/istio/#_1","title":"\uac1c\uc694","text":"<ul> <li>istio \uc608\uc81c</li> </ul>"},{"location":"kubernetes/istio/#_2","title":"\ubaa9\ucc28","text":"<ul> <li>istio \uc124\uce58</li> <li>\uc608\uc81c</li> </ul>"},{"location":"kubernetes/istio/examples/","title":"Index","text":""},{"location":"kubernetes/istio/examples/#_1","title":"\uac1c\uc694","text":"<ul> <li>istio \uc608\uc81c</li> </ul>"},{"location":"kubernetes/istio/examples/#_2","title":"\ubaa9\ucc28","text":"<ul> <li>envoy \uc608\uc81c</li> <li>istio \uc608\uc81c</li> </ul>"},{"location":"kubernetes/istio/examples/envoy/","title":"Index","text":""},{"location":"kubernetes/istio/examples/envoy/#_1","title":"\uac1c\uc694","text":"<ul> <li>envoy proxy \uc608\uc81c</li> </ul>"},{"location":"kubernetes/istio/examples/envoy/#_2","title":"\ubaa9\ucc28","text":"<ul> <li>quick start</li> <li>Host \ud5e4\ub354 \ubcc0\uc870</li> <li>httpbin \ub3c4\ucee4 \ucee8\ud14c\uc774\ub108 \ud638\ucd9c</li> </ul>"},{"location":"kubernetes/istio/examples/envoy/example1_envoy_homepage/","title":"Index","text":""},{"location":"kubernetes/istio/examples/envoy/example1_envoy_homepage/#_1","title":"\uac1c\uc694","text":"<ul> <li>envoy quick start \uc608\uc81c</li> </ul>"},{"location":"kubernetes/istio/examples/envoy/example1_envoy_homepage/#_2","title":"\uc804\uc81c\uc870\uac74","text":"<ul> <li>docker\uac00 \ud544\uc694\ud569\ub2c8\ub2e4.</li> </ul>"},{"location":"kubernetes/istio/examples/envoy/example1_envoy_homepage/#_3","title":"\uc2e4\ud589\ubc29\ubc95","text":"<ol> <li>envoy \ub3c4\ucee4 \ucee8\ud14c\uc774\ub108 \uc2e4\ud589</li> </ol> <pre><code>$ docker run --rm -it envoyproxy/envoy:v1.31.4 --version\nenvoy  version: d045f4201477d50bc64a3bd38c28cfec67c272ca/1.31.4/Clean/RELEASE/BoringSSL\n</code></pre> <ol> <li>envoy \uc124\uc815\ud30c\uc77c \ud655\uc778</li> </ol> <pre><code>cat ./config.yaml\n</code></pre> <ol> <li>envoy \uc124\uc815 \ud30c\uc77c\uc744 \ub9c8\uc6b4\ud2b8\ud558\uc5ec envoy \ub3c4\ucee4 \ucee8\ud14c\uc774\ub108 \uc2e4\ud589</li> </ol> <pre><code>docker run --rm -d \\\n  -v $(pwd)/config.yaml:/etc/envoy/envoy.yaml \\\n  -p 10000:10000 \\\n  --name envoy \\\n  envoyproxy/envoy:v1.31.4 \\\n  envoy -c /etc/envoy/envoy.yaml\n</code></pre> <ol> <li>curl\uc744 \uc0ac\uc6a9\ud558\uc5ec envoy \ub3c4\ucee4 \ucee8\ud14c\uc774\ub108 \ud638\ucd9c</li> </ol> <pre><code>$ curl 127.0.0.1:10000\n&lt;!DOCTYPE html&gt;\n&lt;html lang=\"en\"&gt;\n  &lt;head&gt;\n    &lt;title&gt;Envoy proxy - home&lt;/title&gt;\n\n... \uc774\ud558\uc0dd\ub7b5\n</code></pre> <ol> <li>\uc6f9 \ube0c\ub77c\uc6b0\uc800\uc5d0\uc11c envoy \ub3c4\ucee4 \ucee8\ud14c\uc774\ub108 \ud638\ucd9c</li> </ol> <ol> <li>envoy \ub3c4\ucee4 \ucee8\ud14c\uc774\ub108\uc5d0\uc11c \uc561\uc138\uc2a4 \ub85c\uadf8 \ud655\uc778</li> </ol> <pre><code>$ docker logs envoy\n[2024-12-14T13:29:55.112Z] \"GET / HTTP/1.1\" 200 - 0 15795 586 513 \"-\" \"curl/8.7.1\" \"403ab333-031f-4fff-99ee-2837404dd4e3\" \"www.envoyproxy.io\" \"52.74.232.59:443\"\n</code></pre>"},{"location":"kubernetes/istio/examples/envoy/example1_envoy_homepage/#_4","title":"\uc2e4\uc2b5\ud658\uacbd \uc815\ub9ac","text":"<ul> <li>\uc2e4\uc2b5\uc744 \ub9c8\uce58\uace0 \ub3c4\ucee4 \ucee8\ud14c\uc774\ub108 \uc885\ub8cc</li> </ul> <pre><code>docker kill envoy\n</code></pre>"},{"location":"kubernetes/istio/examples/envoy/example1_envoy_homepage/#_5","title":"\ucc38\uace0\uc790\ub8cc","text":"<ul> <li>https://www.envoyproxy.io/docs/envoy/latest/start/quick-start/run-envoy</li> </ul>"},{"location":"kubernetes/istio/examples/envoy/example2_set_host_from_example/","title":"Index","text":""},{"location":"kubernetes/istio/examples/envoy/example2_set_host_from_example/#_1","title":"\uac1c\uc694","text":"<ul> <li>\uc608\uc81c 1\uc640 \ube44\uc2b7\ud55c envoy\uc124\uc815 \ud30c\uc77c\uc774 \uc788\uc2b5\ub2c8\ub2e4. envoy proxy\ub97c \ud638\ucd9c\ud558\uba74 404 Not Found \uc751\ub2f5\uc744 \ubc1b\uc2b5\ub2c8\ub2e4.</li> <li><code>\uc2e4\ud328\ud55c \uc774\uc720\ub97c \ucc3e\uc544\ubcf4\uace0 \uc62c\ubc14\ub978 \ubc29\ubc95\uc73c\ub85c envoy \ucee8\ud14c\uc774\ub108\ub97c \ud638\ucd9c</code>\ud574\ubcf4\uc138\uc694.</li> <li>curl \ud638\ucd9c \uc2e4\ud328 \ub85c\uadf8</li> </ul> <pre><code>$ curl 127.0.0.1:10000 -v\n*   Trying 127.0.0.1:10000...\n* Connected to 127.0.0.1 (127.0.0.1) port 10000\n&gt; GET / HTTP/1.1\n&gt; Host: 127.0.0.1:10000\n&gt; User-Agent: curl/8.7.1\n&gt; Accept: */*\n&gt;\n* Request completely sent off\n&lt; HTTP/1.1 404 Not Found\n&lt; date: Sat, 14 Dec 2024 14:08:47 GMT\n&lt; server: envoy\n&lt; content-length: 0\n&lt;\n* Connection #0 to host 127.0.0.1 left intact\n</code></pre> <ul> <li>envoy \ub3c4\ucee4 \ucee8\ud14c\uc774\ub108 \ub85c\uadf8</li> </ul> <pre><code>[2024-12-14T14:08:48.073Z] \"GET / HTTP/1.1\" 404 NR 0 0 0 - \"-\" \"curl/8.7.1\" \"17113f41-6b16-4621-a53f-b848ea6de086\" \"127.0.0.1:10000\" \"-\"\n</code></pre>"},{"location":"kubernetes/istio/examples/envoy/example2_set_host_from_example/#_2","title":"\uc804\uc81c\uc870\uac74","text":"<ul> <li>docker\uac00 \ud544\uc694\ud569\ub2c8\ub2e4.</li> </ul>"},{"location":"kubernetes/istio/examples/envoy/example2_set_host_from_example/#_3","title":"\uc815\ub2f5","text":"<ol> <li>\uc608\uc81c 1\uacfc \ub2e4\ub978 \uc810\uc740 route \uc124\uc815\uc785\ub2c8\ub2e4. \uc774 \uc608\uc81c\uc5d0\uc11c\ub294 route\uc5d0 host\uac00 \uc815\uc801\uc73c\ub85c \uc124\uc815\ub418\uc5b4 \uc788\uc2b5\ub2c8\ub2e4. virtual_hosts.domains \ud544\ub4dc\ub97c \ud655\uc778\ud574\ubcf4\uc138\uc694.</li> </ol> <pre><code># 23\ubc88\uc9f8 \uc904\nroute_config:\n  name: local_route\n  virtual_hosts:\n  - name: envoyproxy_io\n    domains: [ \"envoyproxy.io\" ]\n    ... \uc774\ud558 \uc0dd\ub7b5\n</code></pre> <ol> <li>\ub530\ub77c\uc11c envoy \ucee8\ud14c\uc774\ub108\uc5d0 \uc62c\ubc14\ub974\uac8c \ud638\ucd9c\ud558\ub824\uba74, http \ud5e4\ub354\uc5d0 Host\ud544\ub4dc\ub97c \ucd94\uac00\ud574\uc57c \ud569\ub2c8\ub2e4.</li> </ol> <pre><code>curl -H \"Host: envoyproxy.io\" 127.0.0.1:10000\n</code></pre>"},{"location":"kubernetes/istio/examples/envoy/example2_set_host_from_example/#_4","title":"\ucd94\uac00 \ubb38\uc81c","text":"<ul> <li>\uc6f9 \ube0c\ub77c\uc6b0\uc800\uc5d0\uc11c\ub294 \uc5b4\ub5bb\uac8c \ud638\ucd9c\ud574\uc57c \uc751\ub2f5\uc744 \ubc1b\uc744 \uc218 \uc788\uc744\uae4c\uc694?</li> </ul>"},{"location":"kubernetes/istio/examples/envoy/example2_set_host_from_example/#_5","title":"\ucd94\uac00 \ubb38\uc81c \uc815\ub2f5","text":"<ul> <li>hosts\ud30c\uc77c\uc744 \ubcc0\uc870\ud558\uba74 \ub429\ub2c8\ub2e4.</li> </ul> <pre><code>$ sudo vi /etc/hosts\n\n127.0.0.1 envoyproxy.io\n</code></pre>"},{"location":"kubernetes/istio/examples/envoy/example2_set_host_from_example/#_6","title":"\uc2e4\uc2b5\ud658\uacbd \uc815\ub9ac","text":"<ul> <li>\uc2e4\uc2b5\uc744 \ub9c8\uce58\uace0 \ub3c4\ucee4 \ucee8\ud14c\uc774\ub108 \uc885\ub8cc</li> </ul> <pre><code>docker kill envoy\n</code></pre>"},{"location":"kubernetes/istio/examples/envoy/example2_set_host_from_example/#_7","title":"\ucc38\uace0\uc790\ub8cc","text":"<ul> <li>https://www.envoyproxy.io/docs/envoy/latest/start/quick-start/run-envoy</li> </ul>"},{"location":"kubernetes/istio/examples/envoy/example3_httpbin/","title":"Index","text":""},{"location":"kubernetes/istio/examples/envoy/example3_httpbin/#_1","title":"\uac1c\uc694","text":"<ul> <li>envoy proxy\uac00 httpbin \ub3c4\ucee4 \ucee8\ud14c\uc774\ub108\ub97c \ud638\ucd9c\ud560 \uc218 \uc788\ub3c4\ub85d envoy \uc124\uc815\ud30c\uc77c\uc744 \uc218\uc815\ud569\ub2c8\ub2e4.</li> <li>envoy \uc124\uc815\ud30c\uc77c\uc740 \uc608\uc81c 2\ub97c \uc0ac\uc6a9\ud569\ub2c8\ub2e4.</li> </ul>"},{"location":"kubernetes/istio/examples/envoy/example3_httpbin/#_2","title":"\uc804\uc81c\uc870\uac74","text":"<ul> <li>docker, docker-compose\uac00 \ud544\uc694\ud569\ub2c8\ub2e4.</li> </ul>"},{"location":"kubernetes/istio/examples/envoy/example3_httpbin/#_3","title":"\uc2e4\ud589\ubc29\ubc95","text":"<ol> <li>docker-compose \uc2e4\ud589: envoy, httpbin \ub3c4\ucee4 \ucee8\ud14c\uc774\ub108\uac00 \uc2e4\ud589\ub429\ub2c8\ub2e4.</li> </ol> <pre><code>$ docker compose up -d\n[+] Running 3/3\n \u2714 Network example3_httpbin_default  Created\n \u2714 Container httpbin                 Started\n \u2714 Container envoy                   Started\n</code></pre> <ol> <li>\ub3c4\ucee4 \ucee8\ud14c\uc774\ub108 \uc2e4\ud589 \ud655\uc778</li> </ol> <pre><code>$ docker compose ps\nNAME      IMAGE                      COMMAND                  SERVICE   CREATED          STATUS          PORTS\nenvoy     envoyproxy/envoy:v1.31.4   \"envoy -c /etc/envoy\u2026\"   envoy     38 seconds ago   Up 38 seconds   0.0.0.0:10000-&gt;10000/tcp\nhttpbin   kong/httpbin:0.2.1         \"pipenv run gunicorn\u2026\"   httpbin   38 seconds ago   Up 38 seconds   0.0.0.0:8000-&gt;80/tcp\n</code></pre> <ol> <li>envoy proxy \uc124\uc815 \ud655\uc778</li> </ol> <pre><code>$ cat ./config.yaml\n# 23\ubc88\uc9f8 \uc904\nroute_config:\n  name: local_route\n  virtual_hosts:\n  - name: envoyproxy_io\n    domains: [ \"httpbin.local\" ]\n    routes:\n    - match:\n        prefix: \"/\"\n      route:\n        auto_host_rewrite: true\n        cluster: httpbin_service\n\n## 62\ubc88\uc9f8 \uc904\nclusters:\n  - name: httpbin_service\n    type: LOGICAL_DNS\n    # Comment out the following line to test on v6 networks\n    dns_lookup_family: V4_ONLY\n    load_assignment:\n      cluster_name: httpbin\n      endpoints:\n      - lb_endpoints:\n        - endpoint:\n            address:\n              socket_address:\n                address: httpbin\n                port_value: 8000\n</code></pre> <ol> <li>\uc6f9 \ube0c\ub77c\uc6b0\uc800\uc5d0\uc11c httpbin \ud638\ucd9c</li> </ol> <ol> <li>curl\uc744 \uc0ac\uc6a9\ud558\uc5ec envoy \ub3c4\ucee4 \ucee8\ud14c\uc774\ub108 \ud638\ucd9c</li> </ol> <pre><code>$ curl -H \"Host: httpbin.local\" 127.0.0.1:10000\n&lt;!DOCTYPE html&gt;\n&lt;!DOCTYPE html&gt;\n&lt;html lang=\"en\"&gt;\n\n&lt;head&gt;\n    &lt;meta charset=\"UTF-8\"&gt;\n    &lt;title&gt;httpbin.org&lt;/title&gt;\n\n... \uc774\ud558\uc0dd\ub7b5\n</code></pre> <ol> <li>envoy \ub3c4\ucee4 \ucee8\ud14c\uc774\ub108\uc5d0\uc11c \uc561\uc138\uc2a4 \ub85c\uadf8 \ud655\uc778</li> </ol> <pre><code>$ docker logs envoy\nenvoy  | [2024-12-14T15:02:46.954Z] \"GET / HTTP/1.1\" 200 - 0 9593 3 2 \"-\" \"curl/8.7.1\" \"e82af3ac-eb01-4833-86e5-8e82c986d0c6\" \"httpbin\" \"172.21.0.2:80\"\n</code></pre>"},{"location":"kubernetes/istio/examples/envoy/example3_httpbin/#_4","title":"\uc2e4\uc2b5\ud658\uacbd \uc815\ub9ac","text":"<ul> <li>\uc2e4\uc2b5\uc744 \ub9c8\uce58\uace0 \ub3c4\ucee4 \ucee8\ud14c\uc774\ub108 \uc885\ub8cc</li> </ul> <pre><code>docker compose down\n</code></pre>"},{"location":"kubernetes/istio/examples/envoy/example3_httpbin/#_5","title":"\ucc38\uace0\uc790\ub8cc","text":"<ul> <li>https://www.envoyproxy.io/docs/envoy/latest/start/quick-start/run-envoy</li> </ul>"},{"location":"kubernetes/istio/examples/istio/bookinfo/","title":"Index","text":""},{"location":"kubernetes/istio/examples/istio/bookinfo/#_1","title":"\uac1c\uc694","text":"<ul> <li>istio \uacf5\uc2dd \uc608\uc81c \ubc30\ud3ec</li> </ul>"},{"location":"kubernetes/istio/examples/istio/bookinfo/#_2","title":"\uc2e4\uc2b5\ud658\uacbd","text":"<ul> <li>kind \ud074\ub7ec\uc2a4\ud130</li> <li>istio v1.24</li> </ul>"},{"location":"kubernetes/istio/examples/istio/bookinfo/#_3","title":"\ubc30\ud3ec\ubc29\ubc95","text":"<ol> <li>default namespace\uc5d0 istio injection \uc124\uc815</li> </ol> <pre><code>kubectl label namespace default istio-injection=enabled\n</code></pre> <ol> <li>istio \uacf5\uc2dd \uc608\uc81c \ubc30\ud3ec</li> </ol> <pre><code>kubectl apply -f https://raw.githubusercontent.com/istio/istio/release-1.24/samples/bookinfo/platform/kube/bookinfo.yaml -n default\n</code></pre> <ol> <li>pod \uc870\ud68c</li> </ol> <p>istio\uac00 sidecar \ubaa8\ub4dc\uc778 \uacbd\uc6b0 READY\uac00 2/2\uc774\uc5b4\uc57c \ud569\ub2c8\ub2e4.</p> <pre><code>$ kubectl get pod -n default\nNAME                             READY   STATUS    RESTARTS   AGE\ndetails-v1-79dfbd6fff-zn6kd      2/2     Running   0          2m28s\nproductpage-v1-dffc47f64-jcx6m   2/2     Running   0          2m28s\nratings-v1-65f797b499-zt5nl      2/2     Running   0          2m28s\nreviews-v1-5c4d6d447c-gl529      2/2     Running   0          2m28s\nreviews-v2-65cb66b45c-96kff      2/2     Running   0          2m28s\nreviews-v3-f68f94645-kpspf       2/2     Running   0          2m28s\n</code></pre>"},{"location":"kubernetes/istio/examples/istio/bookinfo/#_4","title":"\uc0ad\uc81c\ubc29\ubc95","text":"<pre><code>kubectl delete -f https://raw.githubusercontent.com/istio/istio/release-1.24/samples/bookinfo/platform/kube/bookinfo.yaml -n default\n</code></pre>"},{"location":"kubernetes/istio/examples/istio/bookinfo/#_5","title":"\ucc38\uace0\uc790\ub8cc","text":"<ul> <li>https://istio.io/latest/docs/examples/bookinfo/</li> </ul>"},{"location":"kubernetes/istio/install/","title":"Index","text":""},{"location":"kubernetes/istio/install/#_1","title":"\uac1c\uc694","text":"<ul> <li>istio \uc124\uce58 \ubb38\uc11c</li> </ul>"},{"location":"kubernetes/istio/install/#_2","title":"\ubaa9\ucc28","text":"<ul> <li>EKS\uc5d0\uc11c ArgoCD\uc640 helm chart\ub97c \uc0ac\uc6a9\ud558\uc5ec istio \uc124\uce58</li> <li>kind \ud074\ub7ec\uc2a4\ud130\uc5d0 istio \uc124\uce58</li> <li>helm chart\ub97c \uc0ac\uc6a9\ud558\uc5ec istio \uc124\uce58</li> </ul>"},{"location":"kubernetes/istio/install/eks/","title":"Index","text":""},{"location":"kubernetes/istio/install/eks/#_1","title":"\uac1c\uc694","text":"<ul> <li>EKS\uc5d0\uc11c ArgoCD\uc640 helm chart\ub97c \uc0ac\uc6a9\ud558\uc5ec istio \uc124\uce58</li> </ul>"},{"location":"kubernetes/istio/install/eks/#_2","title":"\uc124\uce58 \ubc29\ubc95","text":"<pre><code>kubectl apply -f ./argocd_bootstrap/argocd-apps.yaml\n</code></pre>"},{"location":"kubernetes/istio/install/eks/addons/","title":"Index","text":""},{"location":"kubernetes/istio/install/eks/addons/#_1","title":"\uac1c\uc694","text":"<ul> <li>istio \uc560\ub4dc\uc628 \uc124\uce58 \uba54\ub274\uc5bc</li> </ul>"},{"location":"kubernetes/istio/install/eks/addons/#_2","title":"\ubaa9\ucc28","text":"<ul> <li>prometheus</li> <li>grafana</li> </ul>"},{"location":"kubernetes/istio/install/eks/addons/grafana/","title":"Grafana","text":""},{"location":"kubernetes/istio/install/eks/addons/grafana/#_1","title":"\uac1c\uc694","text":"<ul> <li>istio mesh\uba54\ud2b8\ub9ad\uc744 \uc2dc\uac01\ud654\ud558\uae30 \uc704\ud574 grafana \uc124\uce58</li> </ul>"},{"location":"kubernetes/istio/install/eks/addons/grafana/#_2","title":"\uc804\uc81c\uc870\uac74","text":"<ul> <li>proemtheus\uac00 \uc124\uce58\ub418\uc5b4 \uc788\uc5b4\uc57c \ud568</li> <li>\uc124\uce58 \ubb38\uc11c \ubc14\ub85c\uac00\uae30</li> </ul>"},{"location":"kubernetes/istio/install/eks/addons/grafana/#_3","title":"\uc124\uce58\ubc29\ubc95","text":"<ul> <li>helm values\uc5d0\uc11c AWS ACM\uacfc host\ub97c \uaf2d \uc5ec\ub7ec\ubd84 \uaec4\ub85c \ubcc0\uacbd\ud558\uc138\uc694!!!</li> </ul> <pre><code>helm repo add grafana https://grafana.github.io/helm-charts\nhelm upgrade --install \\\n  --version '8.6.1' \\\n  -n istio-system --create-namespace \\\n  -f ../argocd_bootstrap/values/grafana.yaml \\\n  grafana grafana/grafana\n</code></pre>"},{"location":"kubernetes/istio/install/eks/addons/grafana/#admin","title":"\uadf8\ub77c\ud30c\ub098 admin \ube44\ubc00\ubc88\ud638","text":"<pre><code>kubectl get secret --namespace istio-system grafana -o jsonpath=\"{.data.admin-password}\" | base64 --decode ; echo\n</code></pre>"},{"location":"kubernetes/istio/install/eks/addons/prometheus/","title":"Prometheus","text":""},{"location":"kubernetes/istio/install/eks/addons/prometheus/#_1","title":"\uac1c\uc694","text":"<ul> <li>istio mesh\uba54\ud2b8\ub9ad \uc218\uc9d1\uc744 \ub2f4\ub2f9\ud558\ub294 \ud504\ub85c\uba54\ud14c\uc6b0\uc2a4 \uc124\uce58</li> </ul>"},{"location":"kubernetes/istio/install/eks/addons/prometheus/#_2","title":"\uc120\uc218\uc9c0\uc2dd","text":"<ul> <li>helm chart\ub85c istio\ub97c \uc124\uce58\ud558\uba74 \ud504\ub85c\uba54\ud14c\uc6b0\uc2a4 exporter\uc124\uc815\uc774 \ub514\ud3f4\ud2b8\ub85c \ud65c\uc131\ud654 \ub418\uc5b4 \uc788\ub2e4.</li> </ul> <pre><code>--set meshConfig.enablePrometheusMerge=true\n</code></pre>"},{"location":"kubernetes/istio/install/eks/addons/prometheus/#_3","title":"\uc124\uce58\ubc29\ubc95","text":"<ul> <li>helm values</li> <li>\uc2a4\ud1a0\ub9ac\uc9c0\ub97c \uc0ac\uc6a9\ud558\uc9c0 \uc54a\uace0 \uc778\uba54\ubaa8\ub9ac\ub97c \uc0ac\uc6a9</li> <li>retenetion \uc124\uc815: 1d\uc640 200MB</li> <li>alertmanager \uc124\uce58\ud558\uc9c0 \uc54a\uc74c</li> </ul> <pre><code>helm repo add prometheus-community https://prometheus-community.github.io/helm-charts\nhelm upgrade --install \\\n  -n istio-system --create-namespace \\\n  --version '25.30.1' \\\n  --set server.retention=\"1d\" \\\n  --set server.retentionSize=\"200MB\" \\\n  --set server.persistentVolume.enabled=false \\\n  --set alertmanager.enabled=false \\\n  prometheus prometheus-community/prometheus\n</code></pre>"},{"location":"kubernetes/istio/install/eks/addons/prometheus/#_4","title":"\ucc38\uace0\uc790\ub8cc","text":"<ul> <li>https://istio.io/latest/docs/ops/integrations/prometheus/</li> </ul>"},{"location":"kubernetes/istio/install/eks/argocd_bootstrap/values/","title":"Index","text":""},{"location":"kubernetes/istio/install/eks/argocd_bootstrap/values/#_1","title":"\uac1c\uc694","text":"<ul> <li>istio \uad00\ub9ac\ub97c \uc704\ud55c \uc560\ub4dc\uc628 helm values</li> </ul>"},{"location":"kubernetes/istio/install/eks/argocd_bootstrap/values/#_2","title":"\ubaa9\ucc28","text":"<ul> <li>grafana</li> <li>prometheus</li> </ul>"},{"location":"kubernetes/istio/install/kind_cluster/","title":"Index","text":""},{"location":"kubernetes/istio/install/kind_cluster/#_1","title":"\uac1c\uc694","text":"<ul> <li>kind \ud074\ub7ec\uc2a4\ud130\uc5d0 istio \uc124\uce58</li> </ul>"},{"location":"kubernetes/istio/install/kind_cluster/#_2","title":"\uc804\uc81c\uc870\uac74","text":"<ul> <li>docker\uac00 \uc124\uce58\ub418\uc5b4 \uc788\uc5b4\uc57c \ud569\ub2c8\ub2e4.</li> <li>kind CLI\uac00 \uc124\uce58\ub418\uc5b4 \uc788\uc5b4\uc57c \ud569\ub2c8\ub2e4.</li> </ul>"},{"location":"kubernetes/istio/install/kind_cluster/#kind","title":"kind \ud074\ub7ec\uc2a4\ud130 \uc0dd\uc131","text":"<ol> <li>kind \ud074\ub7ec\uc2a4\ud130 \uc0dd\uc131</li> </ol> <pre><code>kind create cluster --config kind-config.yaml\n</code></pre> <ol> <li>kind \ud074\ub7ec\uc2a4\ud130 \uc0dd\uc131 \ud655\uc778</li> </ol> <pre><code>$ kubectl get nodes\nNAME                  STATUS   ROLES           AGE     VERSION\nistio-control-plane   Ready    control-plane   3m51s   v1.31.4\nistio-worker          Ready    &lt;none&gt;          3m40s   v1.31.4\nistio-worker2         Ready    &lt;none&gt;          3m41s   v1.31.4\n</code></pre>"},{"location":"kubernetes/istio/install/kind_cluster/#istio","title":"istio \uc124\uce58","text":"<ol> <li>istioctl \uc124\uce58</li> </ol> <pre><code>brew install istioctl\n</code></pre> <ol> <li>istioctl version \ud655\uc778</li> </ol> <pre><code>$ istioctl version\nIstio is not present in the cluster: no running Istio pods in namespace \"istio-system\"\nclient version: 1.24.1\n</code></pre> <ol> <li>istio \uc124\uce58: demo \ud504\ub85c\ud30c\uc77c \uc0ac\uc6a9</li> </ol> <pre><code>istioctl install --set profile=demo --skip-confirmation\n\u2714 Istio core installed \u26f5\ufe0f\n\u2714 Istiod installed \ud83e\udde0\n\u2714 Egress gateways installed \ud83d\udeeb\n\u2714 Ingress gateways installed \ud83d\udeec\n\u2714 Installation complete\n</code></pre> <ol> <li>istio \uc124\uce58 \ud655\uc778</li> </ol> <pre><code>$ kubectl get pod -n istio-system\nNAME                                    READY   STATUS    RESTARTS   AGE\nistio-egressgateway-94bdb56cb-kxsq5     1/1     Running   0          99s\nistio-ingressgateway-86cb558598-zbbv7   1/1     Running   0          99s\nistiod-7dccd8956d-8xlzv                 1/1     Running   0          113s\n</code></pre>"},{"location":"kubernetes/istio/install/kind_cluster/#_3","title":"\ucc38\uace0\uc790\ub8cc","text":"<ul> <li>https://istio.io/latest/docs/setup/platform-setup/kind/</li> <li>https://medium.com/@s4l1h/how-to-install-kind-and-istio-ingress-controller-3b510834c762</li> </ul>"},{"location":"kubernetes/istio/install/manual_helm/","title":"\uac1c\uc694","text":"<ul> <li>helm\uc73c\ub85c istio \uc124\uce58</li> </ul>"},{"location":"kubernetes/istio/install/manual_helm/#_2","title":"\uc124\uce58 \ubc29\ubc95","text":"<ol> <li>istio-base helm chart \ub9b4\ub9ac\uc988</li> <li>istiod helm chart \ub9b4\ub9ac\uc988</li> <li>istio-ingress chart \ub9b4\ub9ac\uc988</li> <li>(\uc635\uc158) istio-egress helm chart \ub9b4\ub9ac\uc988</li> </ol> <pre><code>helm repo add istio https://istio-release.storage.googleapis.com/charts\nhelm repo update\n</code></pre> <ul> <li>helm chart \ub9b4\ub9ac\uc988</li> </ul> <pre><code>helm install istio-base istio/base --version 1.24.0 -n istio-system --create-namespace --set defaultRevision=default\nhelm install istiod istio/istiod --version 1.24.0 -n istio-system --create-namespace --wait\nhelm install istio-ingress istio/gateway --version 1.24.0 -n istio-system --create-namespace --wait\n</code></pre>"},{"location":"kubernetes/karpenter/1.%20what%20is%20karpenter/","title":"1. what is karpenter","text":""},{"location":"kubernetes/karpenter/1.%20what%20is%20karpenter/#karpenter","title":"karpenter\ub780?","text":"<p>karpenter\ub294 \uace0\uc131\ub2a5 \ud074\ub7ec\uc2a4\ud130 \uc624\ud1a0\uc2a4\ucf00\uc77c\ub7ec\uc785\ub2c8\ub2e4.</p> <p>karpenter \uc18c\uac1c\uc640 \uc0ac\uc6a9\ubc29\ubc95 \uc720\ud22c\ube0c \ub9c1\ud06c</p>"},{"location":"kubernetes/karpenter/2.%20how%20to%20determine%20instance%20type/","title":"2. how to determine instance type","text":""},{"location":"kubernetes/karpenter/2.%20how%20to%20determine%20instance%20type/#_1","title":"\uac1c\uc694","text":"<p>\uc774 \ubb38\uc11c\ub294 karpenter\uc5d0\uc11c \uc778\uc2a4\ud134\uc2a4 \ud0c0\uc785 \ud6c4\ubcf4\ub97c \uacb0\uc815\ud558\ub294 \uae30\uc900\uc744 \uc124\uba85\ud569\ub2c8\ub2e4. \uc774 \uae00\uc740 \uc720\ud22c\ube0c \uc601\uc0c1\uc73c\ub85c\ub3c4 \ub9cc\ub098 \ubcfc \uc218 \uc788\uc2b5\ub2c8\ub2e4. \uc544\ub798 \uc774\ubbf8\uc9c0\ub97c \ud074\ub9ad\ud558\uba74 \uc720\ud29c\ubd80 \uc601\uc0c1\uc73c\ub85c \uc774\ub3d9\ud569\ub2c8\ub2e4.</p> <p></p>"},{"location":"kubernetes/karpenter/2.%20how%20to%20determine%20instance%20type/#_2","title":"\uc120\uc815 \uae30\uc900","text":"<p>EKS\ud658\uacbd\uc5d0\uc11c karpenter\ub294 EC2 fleet\uc774 \uc778\uc2a4\ud134\uc2a4 \ud0c0\uc785\uc744 \uc798 \uacb0\uc815\ud560 \uc218 \uc788\ub3c4\ub85d \uc778\uc2a4\ud134\uc2a4 \ud0c0\uc785 \ud6c4\ubcf4\ub97c \uc804\ub2ec\ud569\ub2c8\ub2e4. EC2 fleet\uc740 \uc804\ub2ec\ubc1b\uc740 \uc778\uc2a4\ud134\uc2a4 \ud0c0\uc785 \uc911\uc5d0 \uc801\uc808\ud55c \ud0c0\uc785\uc744 \uc120\ud0dd\ud558\uace0 EKS\ub178\ub4dc\ub97c \uc0dd\uc131\ud569\ub2c8\ub2e4.</p> <p></p> <p>karpenter\uac00 EC2 \uc778\uc2a4\ud134\uc2a4 \ud6c4\ubcf4\ub97c \uacb0\uc815\ud558\ub294 \uae30\uc900\uc740 \uc544\ub798\uc640 \uac19\uc2b5\ub2c8\ub2e4.</p> <ol> <li>pending pod\uc758 resources.request \ud569</li> <li>VPC CNI \ub4f1 daemonset\uc744 \uc2e4\ud589\ud560 \uc5ec\uc720 \ub9ac\uc18c\uc2a4 \uacc4\uc0b0</li> <li>NodePool\uc5d0 \uc815\uc758\ud55c \uc778\uc2a4\ud134\uc2a4 \uc635\uc158\uc744 \uace0\ub824\ud558\uc5ec \uc778\uc2a4\ud134\uc2a4 \ud6c4\ubcf4 \uc120\ud0dd</li> </ol> <p>\uc608\ub97c \ub4e4\uc5b4 \uc544\ub798 \uadf8\ub9bc \ucc98\ub7fc 2\uac1c pod\uac00 \uc788\uc73c\uba74, \uc778\uc2a4\ud134\uc2a4 \ud6c4\ubcf4\uc758 cpu\ub294 3\ucf54\uc5b4\ub97c \ucd08\uacfc\ud574\uc57c \ud569\ub2c8\ub2e4. \uadf8\ub9ac\uace0 NodePool\uc5d0 \uc815\uc758\ud55c \uc778\uc2a4\ud134\uc2a4 \uc635\uc158\uc744 \uace0\ub824\ud558\uc5ec \ucd5c\uc885 \uc778\uc2a4\ud134\uc2a4 \ud6c4\ubcf4\ub97c \uacb0\uc815\ud569\ub2c8\ub2e4.</p>"},{"location":"kubernetes/karpenter/2.%20how%20to%20determine%20instance%20type/#_3","title":"\uc8fc\uc758\uc0ac\ud56d","text":"<p>pending pod\uc5d0 resource.request\uac00 \uc815\uc758\ub418\uc5b4 \uc788\uc9c0 \uc54a\uc73c\uba74, requests \ud569\uc774 0\uc73c\ub85c \uacc4\uc0b0\ub429\ub2c8\ub2e4. \ub530\ub77c\uc11c \uc0ac\uc591\uc774 \ub0ae\uc740 \uc778\uc2a4\ud134\uc2a4 \ud0c0\uc785 \ud6c4\ubcf4\ub4e4\uc774 \uc120\ud0dd\ub420 \ud655\ub960\uc774 \ub192\uc2b5\ub2c8\ub2e4.</p> <p></p>"},{"location":"packer/","title":"Index","text":""},{"location":"packer/#_1","title":"\uac1c\uc694","text":"<ul> <li>packer \uc5f0\uc2b5</li> </ul>"},{"location":"packer/01-build/","title":"Index","text":""},{"location":"packer/01-build/#_1","title":"\uac1c\uc694","text":"<ul> <li>packer tutorial \uc2e4\uc2b5</li> </ul>"},{"location":"packer/01-build/#_2","title":"\uc2e4\uc2b5","text":"<ol> <li>packer \ucd08\uae30\ud654</li> </ol> <pre><code>packer init .\n</code></pre> <ol> <li>pakcer build \uc2e4\ud589</li> </ol> <pre><code>$ packer build aws-ubuntu.pkr.hcl\nlearn-packer.amazon-ebs.ubuntu: output will be in this color.\n\n==&gt; learn-packer.amazon-ebs.ubuntu: Prevalidating any provided VPC information\n==&gt; learn-packer.amazon-ebs.ubuntu: Prevalidating AMI Name: learn-packer-linux-aws\n    learn-packer.amazon-ebs.ubuntu: Found Image ID: ami-086c6008c98cc0aad\n==&gt; learn-packer.amazon-ebs.ubuntu: Creating temporary keypair: packer_676bc54d-fdcd-d48a-60ac-abd57ed413f5\n==&gt; learn-packer.amazon-ebs.ubuntu: Creating temporary security group for this instance: packer_676bc54e-fbe0-7ca5-6fb9-ad87de440a60\n==&gt; learn-packer.amazon-ebs.ubuntu: Authorizing access to port 22 from [0.0.0.0/0] in the temporary security groups...\n==&gt; learn-packer.amazon-ebs.ubuntu: Launching a source AWS instance...\n    learn-packer.amazon-ebs.ubuntu: Instance ID: i-0e80192b9d17821f5\n==&gt; learn-packer.amazon-ebs.ubuntu: Waiting for instance (i-0e80192b9d17821f5) to become ready...\n==&gt; learn-packer.amazon-ebs.ubuntu: Using SSH communicator to connect: 13.125.221.210\n==&gt; learn-packer.amazon-ebs.ubuntu: Waiting for SSH to become available...\n==&gt; learn-packer.amazon-ebs.ubuntu: Connected to SSH!\n==&gt; learn-packer.amazon-ebs.ubuntu: Stopping the source instance...\n    learn-packer.amazon-ebs.ubuntu: Stopping instance\n==&gt; learn-packer.amazon-ebs.ubuntu: Waiting for the instance to stop...\n==&gt; learn-packer.amazon-ebs.ubuntu: Creating AMI learn-packer-linux-aws from instance i-0e80192b9d17821f5\n    learn-packer.amazon-ebs.ubuntu: AMI: ami-042433a869e8caddf\n==&gt; learn-packer.amazon-ebs.ubuntu: Waiting for AMI to become ready...\n==&gt; learn-packer.amazon-ebs.ubuntu: Skipping Enable AMI deprecation...\n==&gt; learn-packer.amazon-ebs.ubuntu: Skipping Enable AMI deregistration protection...\n==&gt; learn-packer.amazon-ebs.ubuntu: Terminating the source AWS instance...\n==&gt; learn-packer.amazon-ebs.ubuntu: Cleaning up any extra volumes...\n==&gt; learn-packer.amazon-ebs.ubuntu: No volumes to clean up, skipping\n==&gt; learn-packer.amazon-ebs.ubuntu: Deleting temporary security group...\n==&gt; learn-packer.amazon-ebs.ubuntu: Deleting temporary keypair...\nBuild 'learn-packer.amazon-ebs.ubuntu' finished after 2 minutes 43 seconds.\n</code></pre> <ul> <li> <ol> <li>EC2 \uc778\uc2a4\ud134\uc2a4 \uc2e4\ud589 \ud655\uc778: packer\uac00 AMI\ub97c \uc0dd\uc131\ud558\uae30 \uc704\ud574 \uc784\uc2dc EC2\uc778\uc2a4\ud134\uc2a4\ub97c \uc0dd\uc131\ud568</li> </ol> </li> </ul> <ul> <li> <ol> <li>packer\uac00 \uc0dd\uc131\ud55c AMI \uc0dd\uc131 \ud655\uc778</li> </ol> </li> </ul>"},{"location":"packer/01-build/#_3","title":"\ucc38\uace0\uc790\ub8cc","text":"<ul> <li>https://developer.hashicorp.com/packer/tutorials/aws-get-started/aws-get-started-build-image</li> </ul>"},{"location":"packer/03-packer_with_codebuild/","title":"Index","text":""},{"location":"packer/03-packer_with_codebuild/#_1","title":"\uac1c\uc694","text":"<ul> <li>packer\ub97c codebuild\ub85c \uc2e4\ud589</li> </ul>"},{"location":"packer/03-packer_with_codebuild/#_2","title":"\uc2e4\uc2b5 \uc608\uc81c","text":""},{"location":"packer/03-packer_with_codebuild/#buildspecyaml","title":"buildspec.yaml","text":"<pre><code>version: 0.2\n\nphases:\n  install:\n    commands:\n    - echo Installing Packer...\n    - sudo yum install -y yum-utils\n    - sudo yum-config-manager --add-repo https://rpm.releases.hashicorp.com/AmazonLinux/hashicorp.repo\n    - sudo yum -y install packer\n  build:\n    commands:\n    - echo Starting Packer build...\n    - packer init ./\n    - packer build al2023-nginx.pkr.hcl\nartifacts:\n  files:\n  - '**/*'\n</code></pre>"},{"location":"packer/03-packer_with_codebuild/#al2023-nginxpkrhcl","title":"al2023-nginx.pkr.hcl","text":"<pre><code>packer {\n  required_plugins {\n    amazon = {\n      version = \"&gt;= 1.2.8\"\n      source  = \"github.com/hashicorp/amazon\"\n    }\n  }\n}\n\nsource \"amazon-ebs\" \"nginx\" {\n  ami_name      = \"al2023-nginx-{{timestamp}}\"\n  instance_type = \"t4g.medium\"\n  region        = \"ap-northeast-2\"\n\n  source_ami_filter {\n    filters = {\n      name                = \"al2023-ami-minimal-2023.6.*\"\n      root-device-type    = \"ebs\"\n      virtualization-type = \"hvm\"\n    }\n    owners      = [\"137112412989\"] # Amazon\n    most_recent = true\n  }\n\n  ssh_username = \"ec2-user\"\n}\n\nbuild {\n  name = \"nginx-golden-image\"\n  sources = [\n    \"source.amazon-ebs.nginx\"\n  ]\n  provisioner \"shell\" {\n    inline = [\n      \"sudo yum -y install nginx\",\n      \"sudo systemctl enable nginx\",\n    ]\n  }\n}\n</code></pre>"},{"location":"packer/03-packer_with_codebuild/#codebuild","title":"\ud14c\ub77c\ud3fc\uc73c\ub85c \uc0dd\uc131\ud558\ub294 codebuild","text":"<pre><code>terraform {\n  required_providers {\n    aws = {\n      source  = \"hashicorp/aws\"\n      version = \"5.81.0\"\n    }\n  }\n\n  required_version = \"&gt;= 1.4\"\n}\n\nprovider \"aws\" {\n  region = \"ap-northeast-2\"\n}\n\nresource \"aws_codebuild_project\" \"example\" {\n  name          = \"example-codebuild-project\"\n  description   = \"Example CodeBuild project\"\n  build_timeout = 180\n\n  environment {\n    compute_type                = \"BUILD_GENERAL1_SMALL\"\n    image                       = \"aws/codebuild/amazonlinux-x86_64-standard:5.0-23.05.22\"\n    type                        = \"LINUX_CONTAINER\"\n    image_pull_credentials_type = \"CODEBUILD\"\n  }\n\n  service_role = aws_iam_role.codebuild_role.arn\n\n  source {\n    type            = \"GITHUB\"\n    location        = \"https://github.com/choisungwook/portfolio\"\n    git_clone_depth = 1\n    buildspec       = \"packer/3_packer_with_codebuild/codebuild/buildspec.yaml\"\n  }\n\n  # reference: https://github.com/choisungwook/portfolio/pull/135\n  source_version = \"613e58245f9ce62a7f50653ceb8d8207d05ee032\"\n\n  artifacts {\n    type = \"NO_ARTIFACTS\"\n  }\n\n  tags = {\n    Environment = \"test\"\n  }\n}\n\nresource \"aws_iam_role\" \"codebuild_role\" {\n  name = \"codebuild-role\"\n\n  assume_role_policy = jsonencode({\n    Version = \"2012-10-17\"\n    Statement = [\n      {\n        Action = \"sts:AssumeRole\"\n        Effect = \"Allow\"\n        Principal = {\n          Service = \"codebuild.amazonaws.com\"\n        }\n      }\n    ]\n  })\n\n  tags = {\n    Environment = \"test\"\n  }\n}\n\nresource \"aws_iam_role_policy\" \"codebuild_policy\" {\n  name = \"codebuild-policy\"\n  role = aws_iam_role.codebuild_role.id\n\n  policy = jsonencode({\n    Version = \"2012-10-17\"\n    Statement = [\n      {\n        Action = [\n          \"s3:GetObject\",\n          \"s3:PutObject\"\n        ]\n        Effect   = \"Allow\"\n        Resource = \"*\"\n      },\n      {\n        Action = [\n          \"ec2:AttachVolume\",\n          \"ec2:AuthorizeSecurityGroupIngress\",\n          \"ec2:CopyImage\",\n          \"ec2:CreateImage\",\n          \"ec2:CreateKeypair\",\n          \"ec2:CreateSecurityGroup\",\n          \"ec2:CreateSnapshot\",\n          \"ec2:CreateTags\",\n          \"ec2:CreateVolume\",\n          \"ec2:DeleteKeyPair\",\n          \"ec2:DeleteSecurityGroup\",\n          \"ec2:DeleteSnapshot\",\n          \"ec2:DeleteVolume\",\n          \"ec2:DeregisterImage\",\n          \"ec2:DescribeImageAttribute\",\n          \"ec2:DescribeImages\",\n          \"ec2:DescribeInstances\",\n          \"ec2:DescribeInstanceStatus\",\n          \"ec2:DescribeRegions\",\n          \"ec2:DescribeSecurityGroups\",\n          \"ec2:DescribeSnapshots\",\n          \"ec2:DescribeSubnets\",\n          \"ec2:DescribeTags\",\n          \"ec2:DescribeVolumes\",\n          \"ec2:DetachVolume\",\n          \"ec2:GetPasswordData\",\n          \"ec2:ModifyImageAttribute\",\n          \"ec2:ModifyInstanceAttribute\",\n          \"ec2:ModifySnapshotAttribute\",\n          \"ec2:RegisterImage\",\n          \"ec2:RunInstances\",\n          \"ec2:StopInstances\",\n          \"ec2:TerminateInstances\"\n        ]\n        Effect   = \"Allow\"\n        Resource = \"*\"\n      }\n    ]\n  })\n}\n</code></pre>"},{"location":"packer/03-packer_with_codebuild/#codebuild_buildsh","title":"codebuild_build.sh","text":"<ul> <li>codebuild github\uc5d0\uc11c \ub2e4\uc6b4\ub85c\ub4dc \ud558\uc138\uc694</li> </ul>"},{"location":"packer/03-packer_with_codebuild/#_3","title":"\ub85c\uceec \uc2e4\ud589","text":"<ul> <li>$HOME/.aws/config\ud30c\uc77c\uc5d0 \uc124\uc815\ub41c default \ud504\ub85c\ud30c\uc77c\ub85c codebuild\ub97c \ub85c\uceec\ub85c \uc2e4\ud589\ud569\ub2c8\ub2e4. \uc544\ub798 \uc608\uc81c\ub294 ARM \ub9e5\ubd81(aarch64)\uc5d0\uc11c \uc2e4\ud589\ud55c \uc608\uc81c\uc785\ub2c8\ub2e4.</li> </ul> <pre><code>./codebuild_build.sh \\\n  -i public.ecr.aws/codebuild/amazonlinux2-aarch64-standard:3.0 \\\n  -l public.ecr.aws/codebuild/local-builds:aarch64 \\\n  -c \\\n  -p default \\\n  -b buildspec-local.yaml \\\n  -a artifacts\n</code></pre> <ul> <li>ARM \ub9e5\ubd81\uc5d0\uc11c \uc2e4\ud589\ud558\ub824\uba74 packer \uc124\uc815\uc5d0\uc11c \uc778\uc2a4\ud134\uc2a4\ud0c0\uc785\uc744 graviton\uc73c\ub85c \ubcc0\uacbd\ud574\uc57c \ud569\ub2c8\ub2e4.</li> </ul> <pre><code>source \"amazon-ebs\" \"nginx\" {\n  ami_name      = \"al2023-nginx-{{timestamp}}\"\n  instance_type = \"t4g.medium\" # &lt;-- change\n</code></pre> <ul> <li>AWS console\uc5d0\uc11c \uc0dd\uc131\ub41c AMI\ub97c \ud655\uc778\ud569\ub2c8\ub2e4.</li> </ul>"},{"location":"packer/03-packer_with_codebuild/#codebuild_1","title":"codebuild \uc2e4\ud589","text":"<ol> <li>terraform\uc73c\ub85c codebuild\ub97c \uc0dd\uc131\ud569\ub2c8\ub2e4.</li> </ol> <pre><code>terraform init\nterraform apply\n</code></pre> <ol> <li>codebuild\ub97c \uc2e4\ud589\ud558\uace0 \uc2e4\ud589\uacb0\uacfc\uac00 \uc131\uacf5\ud588\ub294\uc9c0 \ud655\uc778\ud569\ub2c8\ub2e4.</li> </ol> <ol> <li>AMI\uac00 \uc0dd\uc131\ub418\uc5c8\ub294\uc9c0 \ud655\uc778\ud569\ub2c8\ub2e4.</li> </ol>"},{"location":"packer/03-packer_with_codebuild/#_4","title":"\ucc38\uace0\uc790\ub8cc","text":"<ul> <li>https://github.com/aws/aws-codebuild-docker-images/blob/master/local_builds/codebuild_build.sh</li> </ul>"},{"location":"terraform/terraform%20code/","title":"Terraform code","text":""},{"location":"terraform/terraform%20code/#_1","title":"\uac1c\uc694","text":"<ul> <li>terraform code \uc815\ub9ac</li> </ul>"},{"location":"terraform/terraform%20code/#iam","title":"IAM","text":""},{"location":"terraform/terraform%20code/#assume-role","title":"Assume role","text":"<ul> <li>aws_iam_role\uc758 TrustRelationShip \uc124\uc815\uc740 assume_role_policy\ud544\ub4dc\ub85c \uc124\uc815</li> <li>aws_iam_role\uc758 policy\ub294 aws_iam_role_policy resource\ub85c \uc124\uc815</li> </ul> <pre><code>resource \"aws_iam_role\" \"web_app\" {\n  name = \"web-app-assume-role\"\n  path = \"/\"\n  assume_role_policy = data.aws_iam_policy_document.web_app_assume.json\n}\n\ndata \"aws_iam_policy_document\" \"web_app_assume\" {\n  statement {\n    effect = \"Allow\"\n    actions = [\"sts:AssumeRole\"]\n    principals {\n      type = \"AWS\"\n      identifiers = [\"arn:aws:iam::${var.aws_root_account_id}:root\"]\n    }\n  }\n}\n\nresource \"aws_iam_role_policy\" \"web_app_s3\" {\n  name = \"web-app-s3-access\"\n  role = aws_iam_role.web_app.id\n  policy = data.aws_iam_policy_document.web_app_policy.json\n}\n\ndata \"aws_iam_policy_document\" \"web_app_policy\" {\n  statement {\n    effect = \"Allow\"\n    actions = [\n      \"s3:List*\",\n      \"s3:Get*\"\n    ]\n    resources = [\"*\"]\n  }\n}\n</code></pre>"},{"location":"terraform/terraform%20code/#ec2","title":"EC2","text":""},{"location":"terraform/terraform%20code/#spot-instance","title":"Spot instance","text":"<pre><code>resource \"aws_spot_instance_request\" \"nginx\" {\n  ami                  = data.aws_ami.ubuntu.id\n  spot_price           = var.spot_price\n  instance_type        = var.spot_instance_type\n  spot_type            = var.spot_type\n  wait_for_fulfillment = \"true\"\n  security_groups      = [aws_security_group.nginx.id]\n  subnet_id            = var.subnet_id\n\n  tags = {\n    Name = \"${var.tag_prefix}-nginx\"\n  }\n}\n\nvariable \"tag_prefix\" {\n  description = \"tag prefix\"\n  type        = string\n  default     = \"Example1\"\n}\n\nvariable \"vpc_id\" {\n  description = \"id\"\n  type        = string\n}\n\nvariable \"subnet_id\" {\n  description = \"subnets id\"\n  type        = string\n}\n\nvariable \"spot_instance_type\" {\n  description = \"spot instance type\"\n  type        = string\n  default     = \"t4g.nano\"\n}\n\nvariable \"spot_type\" {\n  description = \"spot type\"\n  type        = string\n  default     = \"one-time\"\n\n}\n\nvariable \"spot_price\" {\n  description = \"spot price\"\n  type        = string\n  default     = \"0.01\"\n}\n\ndata \"aws_ami\" \"ubuntu\" {\n  most_recent = true\n  owners      = [\"amazon\"]\n\n  filter {\n    name   = \"architecture\"\n    values = [\"arm64\"]\n  }\n\n  filter {\n    name   = \"name\"\n    values = [\"ubuntu/images/hvm-ssd/ubuntu-jammy-22.04-arm64-server-*\"]\n  }\n\n  filter {\n    name   = \"virtualization-type\"\n    values = [\"hvm\"]\n  }\n\n  filter {\n    name   = \"root-device-type\"\n    values = [\"ebs\"]\n  }\n}\n\ndata \"aws_iam_policy_document\" \"ec2_assume_role\" {\n  statement {\n    actions = [\"sts:AssumeRole\"]\n\n    principals {\n      type        = \"Service\"\n      identifiers = [\"ec2.amazonaws.com\"]\n    }\n  }\n}\n\ndata \"aws_iam_policy\" \"systems_manager\" {\n  arn = \"arn:aws:iam::aws:policy/AmazonSSMManagedInstanceCore\"\n}\n\n\nresource \"aws_security_group\" \"nginx\" {\n  name        = \"terraform-test-nginx\"\n  description = \"${var.tag_prefix}-nginx security group\"\n  vpc_id      = var.vpc_id\n\n  ingress {\n    description = \"http\"\n    from_port   = 80\n    to_port     = 80\n    protocol    = \"tcp\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  ingress {\n    description = \"icmp\"\n    from_port   = 0\n    to_port     = 0\n    protocol    = \"icmp\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  egress {\n    from_port   = 0\n    to_port     = 0\n    protocol    = \"-1\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  lifecycle {\n    create_before_destroy = true\n  }\n}\n\nresource \"aws_iam_instance_profile\" \"ssm\" {\n  name = \"terraform-test-ssm-instanceprofile\"\n  role = aws_iam_role.ssm.name\n}\n\nresource \"aws_iam_role\" \"ssm\" {\n  name               = \"terraform-test-ssm-iamrole\"\n  assume_role_policy = data.aws_iam_policy_document.ec2_assume_role.json\n}\n\nresource \"aws_iam_role_policy_attachment\" \"ssm\" {\n  role       = aws_iam_role.ssm.name\n  policy_arn = data.aws_iam_policy.systems_manager.arn\n}\n</code></pre>"},{"location":"tools/","title":"Index","text":""},{"location":"tools/#_1","title":"\uac1c\uc694","text":"<ul> <li>\ub0b4\uac00 \uc0ac\uc6a9\ud558\ub294 \ub3c4\uad6c \ubaa9\ub85d</li> </ul>"},{"location":"tools/#_2","title":"\ubaa9\ub85d","text":"<ul> <li>kit</li> </ul>"},{"location":"tools/kit/","title":"Kit","text":""},{"location":"tools/kit/#_1","title":"\uac1c\uc694","text":"<ul> <li>\ub85c\uceec\uc5d0\uc11c \uc27d\uac8c \uc2e4\ud589\ud560 \uc218 \uc788\ub294 DAG \ub3c4\uad6c\ub85c\uc11c, makefile\uc744 DAG\ub85c \uad6c\uc131\ud560 \ub54c \uc0ac\uc6a9</li> <li>github: https://github.com/kitproj/kit</li> </ul>"},{"location":"tools/kit/#_2","title":"\uc124\uce58 \ubc29\ubc95","text":"<pre><code>brew tap kitproj/kit --custom-remote https://github.com/kitproj/kit\nbrew install kit\n</code></pre>"}]}